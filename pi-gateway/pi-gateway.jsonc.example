{
  // Production-ready example: role-workspace-channel mapping + multi-agent routing
  // Copy to: pi-gateway.jsonc

  "gateway": {
    "port": 52134,
    "bind": "0.0.0.0",
    "auth": {
      "mode": "token",
      "token": "${PI_GATEWAY_TOKEN}",
      "allowUnauthenticated": false
    },
    "commands": {
      "restart": false
    }
  },

  "agent": {
    "piCliPath": "pi",
    "model": "openai-codex/gpt-5.3-codex",
    "thinkingLevel": "medium",
    "pool": {
      "min": 1,
      "max": 6,
      "idleTimeoutMs": 300000
    },
    "tools": {
      "profile": "coding",
      "allow": ["read", "edit", "write", "grep", "bash"]
    },
    "sandbox": {
      "mode": "off",
      "scope": "session"
    },
    "messageMode": "steer",
    "timeoutMs": 900000,
    "extensions": [
      "~/.pi/agent/extensions/role-persona/index.ts"
    ]
  },

  "session": {
    // main | per-peer | per-channel-peer | per-account-channel-peer
    "dmScope": "per-account-channel-peer",
    "dataDir": "~/.pi/gateway/sessions",
    "continueOnRestart": true
  },

  "channels": {
    "telegram": {
      "enabled": true,
      "botToken": "${TELEGRAM_BOT_TOKEN}",
      "dmPolicy": "allowlist",
      "allowFrom": [1050271633],
      "mediaMaxMb": 256,
      "streamMode": "partial",
      "groups": {
        "-5106685069": {
          "requireMention": false,
          "groupPolicy": "open",
          "role": "ops"
        },
        "-5211232825": {
          "requireMention": false,
          "groupPolicy": "open",
          "role": "architect"
        },
        "-1003835388833": {
          "requireMention": false,
          "groupPolicy": "open",
          "role": "research"
        },
        "*": {
          "enabled": false
        }
      }
    },

    "discord": {
      "enabled": true,
      "token": "${DISCORD_BOT_TOKEN}",
      "dmPolicy": "allowlist",
      "dm": {
        "enabled": true,
        "allowFrom": ["123456789012345678"]
      },
      "guilds": {
        "guild-001": {
          "requireMention": false,
          "role": "architect",
          "channels": {
            "channel-ops": { "role": "ops" },
            "channel-docs": { "role": "docs" }
          }
        }
      }
    }
  },

  "roles": {
    "mergeMode": "append",
    "workspaceDirs": {
      "default": "~/.pi/gateway/workspaces/default",
      "ops": "~/projects/ops-workspace",
      "docs": "~/projects/docs-workspace",
      "architect": "~/projects/architecture-workspace",
      "research": "~/projects/research-workspace"
    },
    "capabilities": {
      "ops": {
        "skills": ["~/.pi/agent/skills/server-status-push"],
        "extensions": []
      },
      "docs": {
        "skills": ["~/.pi/agent/skills/workhub"]
      }
    }
  },

  "agents": {
    "default": "main",
    "list": [
      {
        "id": "main",
        "workspace": "~/projects/main-workspace",
        "model": "openai-codex/gpt-5.3-codex",
        "role": "default"
      },
      {
        "id": "ops",
        "workspace": "~/projects/ops-workspace",
        "model": "openai/gpt-4.1",
        "role": "ops"
      },
      {
        "id": "docs",
        "workspace": "~/projects/docs-workspace",
        "model": "anthropic/claude-sonnet-4",
        "role": "docs"
      },
      {
        "id": "architect",
        "workspace": "~/projects/architecture-workspace",
        "model": "anthropic/claude-sonnet-4",
        "role": "architect"
      }
    ],

    "bindings": [
      {
        "agentId": "ops",
        "match": {
          "channel": "telegram",
          "peer": { "kind": "group", "id": "-5106685069" }
        }
      },
      {
        "agentId": "docs",
        "match": {
          "channel": "telegram",
          "peer": { "kind": "group", "id": "-5211232825" }
        }
      },
      {
        "agentId": "architect",
        "match": {
          "channel": "discord",
          "guildId": "guild-001",
          "roles": ["role-architect", "role-lead"]
        }
      },
      {
        // thread inherit example: child thread follows parent channel binding
        "agentId": "ops",
        "match": {
          "channel": "discord",
          "parentPeer": { "kind": "channel", "id": "channel-ops" }
        }
      }
    ]
  },

  "delegation": {
    "timeoutMs": 120000,
    "maxTimeoutMs": 600000,
    "onTimeout": "abort",
    "maxDepth": 1,
    "maxConcurrent": 2
  },

  "cron": {
    "enabled": true,
    "jobs": []
  },

  "hooks": {
    "enabled": false,
    "path": "/hooks"
  },

  "plugins": {
    "dirs": [],
    "disabled": [],
    "config": {
      "concise-mode": {
        "enabled": true,
        "channels": ["telegram", "discord"]
      }
    }
  },

  "logging": {
    "file": false,
    "level": "info",
    "retentionDays": 7
  },

  "queue": {
    "maxPerSession": 15,
    "globalMaxPending": 100,
    "collectDebounceMs": 1500,
    "poolWaitTtlMs": 30000,
    "mode": "collect",
    "dropPolicy": "summarize",
    "dedup": {
      "enabled": true,
      "cacheSize": 1000,
      "ttlMs": 60000
    },
    "priority": {
      "dm": 10,
      "group": 5,
      "webhook": 3,
      "allowlistBonus": 2
    }
  }
}
