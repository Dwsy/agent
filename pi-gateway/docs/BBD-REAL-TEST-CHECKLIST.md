# pi-gateway v2 Telegram çœŸå®ç¯å¢ƒæµ‹è¯•æ¸…å•

> Target: 115.191.43.169:18789 | Bot: @pi_gateway_bot
> Tester: MintTiger | Date: 2026-02-11

## è‡ªåŠ¨åŒ–æµ‹è¯•ï¼ˆscripts/bbd-real-test.shï¼‰

| # | æµ‹è¯•é¡¹ | é¢„æœŸ | æ–¹æ³• |
|---|--------|------|------|
| T1 | Gateway å¯è¾¾ | HTTP 200 | curl / |
| T2 | Metrics å­—æ®µå®Œæ•´ | pool/queue/latency/counters | curl /api/metrics |
| T3 | Webhook 429 | é˜Ÿåˆ—æ»¡æ—¶è¿”å› 429 | å¿«é€Ÿè¿å‘ 20 æ¡ |
| T4 | WebSocket è¿æ¥ | æ”¶åˆ°å“åº” | websocat ws:// |
| T5 | Config token è„±æ• | *** æˆ– mode=off | curl /api/config |

## Telegram æ‰‹åŠ¨æµ‹è¯•

### P0: æ¶ˆæ¯ä¸é‡å¤
| # | æ“ä½œ | é¢„æœŸ | Pass/Fail |
|---|------|------|-----------|
| TG-1 | å‘é€ "ä½ å¥½" | æ”¶åˆ° 1 æ¡å›å¤ï¼Œæ— é‡å¤ | |
| TG-2 | å‘é€ "123" | æ”¶åˆ° 1 æ¡å›å¤ï¼Œæ— é‡å¤ | |
| TG-3 | 60s å†…å†å‘ "ä½ å¥½" | è¢«å»é‡ï¼Œæ— å›å¤ | |
| TG-4 | 61s åå†å‘ "ä½ å¥½" | æ­£å¸¸å›å¤ | |

### P0: Thinking ä¸æ³„æ¼
| # | æ“ä½œ | é¢„æœŸ | Pass/Fail |
|---|------|------|-----------|
| TG-5 | å‘é€éœ€è¦æ€è€ƒçš„é—®é¢˜ï¼ˆå¦‚ "åˆ†æä¸€ä¸‹ pi-gateway çš„æ¶æ„"ï¼‰ | å›å¤ä¸­æ—  `<think>` æ ‡ç­¾ | |
| TG-6 | è§‚å¯Ÿå›å¤è¿‡ç¨‹ | ğŸ’­ blockquote å‡ºç°åè¢«æ­£å¼æ–‡æœ¬æ›¿æ¢ | |

### P0: Streaming + Throttle
| # | æ“ä½œ | é¢„æœŸ | Pass/Fail |
|---|------|------|-----------|
| TG-7 | å‘é€éœ€è¦é•¿å›å¤çš„é—®é¢˜ | æ–‡å­—é€æ­¥æ›´æ–°ï¼ˆæµå¼æ•ˆæœï¼‰ | |
| TG-8 | è§‚å¯Ÿæ›´æ–°é¢‘ç‡ | â‰ˆ1 edit/secï¼ˆ1000ms throttleï¼‰ | |
| TG-9 | é•¿å›å¤è¿‡ç¨‹ä¸­æ— æ¶ˆæ¯é—ªçƒ/ä¸¢å¤± | ç¨³å®šæ›´æ–° | |

### P0: Tool Call æ ¼å¼
| # | æ“ä½œ | é¢„æœŸ | Pass/Fail |
|---|------|------|-----------|
| TG-10 | è®© agent è¯»æ–‡ä»¶ï¼ˆå¦‚ "è¯»ä¸€ä¸‹ package.json"ï¼‰ | æ˜¾ç¤º `â†’ read \`package.json\`` | |
| TG-11 | è®© agent æ‰§è¡Œå‘½ä»¤ï¼ˆå¦‚ "è¿è¡Œ ls"ï¼‰ | æ˜¾ç¤º `â†’ bash \`ls\`` | |

### M2: Collect Mode
| # | æ“ä½œ | é¢„æœŸ | Pass/Fail |
|---|------|------|-----------|
| TG-12 | Agent å¤„ç†ä¸­å¿«é€Ÿè¿å‘ 3 æ¡æ¶ˆæ¯ | åˆå¹¶ä¸º 1 ä¸ª promptï¼ˆ[Queued messages]ï¼‰ | |
| TG-13 | è§‚å¯Ÿåˆå¹¶åçš„å›å¤ | å›å¤æ¶µç›–æ‰€æœ‰ 3 æ¡æ¶ˆæ¯å†…å®¹ | |

### M4: Steer/Interrupt
| # | æ“ä½œ | é¢„æœŸ | Pass/Fail |
|---|------|------|-----------|
| TG-14 | é»˜è®¤ steer æ¨¡å¼ï¼šagent å¤„ç†ä¸­å‘æ–°æ¶ˆæ¯ | æ–°æ¶ˆæ¯è¢«æ³¨å…¥ï¼Œagent ç»§ç»­ | |
| TG-15 | /queue interrupt åˆ‡æ¢åå‘æ¶ˆæ¯ | agent ä¸­æ–­å½“å‰ä»»åŠ¡ï¼Œå¤„ç†æ–°æ¶ˆæ¯ | |
| TG-16 | /queue follow-up åˆ‡æ¢åå‘æ¶ˆæ¯ | æ–°æ¶ˆæ¯æ’é˜Ÿï¼Œç­‰å½“å‰ä»»åŠ¡å®Œæˆ | |

### P4: è§’è‰²åˆ‡æ¢
| # | æ“ä½œ | é¢„æœŸ | Pass/Fail |
|---|------|------|-----------|
| TG-17 | /role | åˆ—å‡ºå¯ç”¨è§’è‰² | |
| TG-18 | /role coding | åˆ‡æ¢åˆ° coding è§’è‰² | |
| TG-19 | åˆ‡æ¢åå‘æ¶ˆæ¯ | ä½¿ç”¨æ–°è§’è‰²çš„ prompt | |

### HTML æ¸²æŸ“
| # | æ“ä½œ | é¢„æœŸ | Pass/Fail |
|---|------|------|-----------|
| TG-20 | è®© agent è¾“å‡ºä»£ç å— | Telegram æ­£ç¡®æ˜¾ç¤º `<pre>` ä»£ç å— | |
| TG-21 | è®© agent è¾“å‡ºç²—ä½“/æ–œä½“ | æ­£ç¡®æ˜¾ç¤º `<b>` / `<i>` | |

## æ‰§è¡Œæ–¹å¼

```bash
# 1. è‡ªåŠ¨åŒ–æµ‹è¯•
cd pi-gateway && bash scripts/bbd-real-test.sh

# 2. Telegram æ‰‹åŠ¨æµ‹è¯•
# åœ¨ Telegram ä¸­é€é¡¹æ“ä½œï¼Œè®°å½• Pass/Fail
```
