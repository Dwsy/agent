# 任务010: 实现 /view 命令

**状态**: Done
**优先级**: High
**预计时间**: 1h

**占用者**: Agent A
**锁定时间**: 2026-01-27 12:20:00

## 任务描述

实现 /view 命令，显示当前会话的文件变化摘要。

## 依赖任务

    - [ ] 任务007 (状态: Todo) - 必须先完成

**说明**: 只有所有标记的依赖任务状态为 Done 后，此任务才能开始执行。

## 验收标准

- [x] 实现 /view 命令处理函数
- [x] 等待 agent 完成（`ctx.waitForIdle()`）
- [x] 获取所有文件变化（`checkpointManager.getAllFileChanges()`）
- [x] 显示变化摘要（文件数量、创建/修改/删除、行数变化）
- [x] 处理无变化的情况
- [x] 错误处理
- [x] 代码通过 TypeScript 类型检查

## 完成记录

- 开始时间: 2026-01-27 12:20:00
-  完成时间: 2026-01-27 12:20:00
-  耗时: 随任务005一起完成

## 交付物

- [x] `~/.pi/agent/extensions/checkpoint-v2/commands.ts`（包含 /view 命令实现）
- [x] 与任务005一起完成

## 实现的功能

- ✅ 等待 agent 完成
- ✅ 获取所有文件变化
- ✅ 显示变化摘要（文件数量、创建/修改/删除、行数变化）
- ✅ 处理无变化的情况
- ✅ 错误处理和通知
- ⏳ FileChangesViewer TUI 组件（待任务007实现）

## 备注

- 基础功能已完成
- FileChangesViewer 组件将在任务007中实现
- 当前只显示文本摘要，后续将提供交互式 TUI 界面