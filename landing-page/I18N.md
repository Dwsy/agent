# i18n (国际化) 文档

Pi Agent 落地页支持中英文双语切换，用户可以通过导航栏的语言按钮自由切换。

## 功能特性

- **双语支持**: 中文（zh-CN）和英文（en-US）
- **实时切换**: 点击导航栏语言按钮立即切换
- **本地存储**: 语言偏好保存在 localStorage
- **组件级订阅**: 所有组件自动响应语言变化

## 使用方法

### 在组件中使用 i18n

```typescript
import { html, LitElement, css } from "lit";
import { customElement, state } from "lit/decorators.js";
import { i18n, type Locale } from "../i18n/i18n-manager";

@customElement("my-component")
export class MyComponent extends LitElement {
  @state()
  locale: Locale = i18n.getCurrentLocale();

  connectedCallback() {
    super.connectedCallback();
    i18n.subscribe(() => {
      this.locale = i18n.getCurrentLocale();
      this.requestUpdate();
    });
  }

  disconnectedCallback() {
    super.disconnectedCallback();
    // Unsubscribe 由 i18n manager 管理
  }

  render() {
    return html`
      <p>${i18n.t("path.to.translation")}</p>
    `;
  }
}
```

### 添加新翻译

1. 在 `src/i18n/locales/zh-CN.ts` 添加中文翻译：

```typescript
export default {
  myModule: {
    title: "我的标题",
    description: "我的描述",
  },
} as const;
```

2. 在 `src/i18n/locales/en-US.ts` 添加英文翻译：

```typescript
export default {
  myModule: {
    title: "My Title",
    description: "My Description",
  },
} as const;
```

3. 在组件中使用：

```typescript
i18n.t("myModule.title")
i18n.t("myModule.description")
```

### 添加新语言

1. 创建语言文件 `src/i18n/locales/ja-JP.ts`：

```typescript
export default {
  // 翻译内容
} as const;
```

2. 在 `src/i18n/i18n-manager.ts` 中注册：

```typescript
import jaJP from "./locales/ja-JP";

const LOCALES: Record<Locale, Translation> = {
  "zh-CN": zhCN,
  "en-US": enUS,
  "ja-JP": jaJP, // 添加新语言
};
```

3. 更新可用语言列表：

```typescript
getAvailableLocales(): Array<{ code: Locale; label: string }> {
  return [
    { code: "zh-CN", label: "中文" },
    { code: "en-US", label: "English" },
    { code: "ja-JP", label: "日本語" }, // 添加新语言
  ];
}
```

## 翻译文件结构

```typescript
export default {
  common: {
    // 通用文本
  },
  navbar: {
    // 导航栏翻译
  },
  hero: {
    // Hero 区域翻译
  },
  // ... 其他模块
} as const;
```

## API

### i18n.t(path: string): string

获取翻译文本。

```typescript
i18n.t("hero.title") // "使用多模型 AI 构建智能系统"
i18n.t("hero.ctas.primary") // "开始使用"
```

**路径规则**: 使用 `.` 分隔嵌套属性。

### i18n.getCurrentLocale(): Locale

获取当前语言代码。

```typescript
i18n.getCurrentLocale() // "zh-CN" 或 "en-US"
```

### i18n.setLocale(locale: Locale): void

设置当前语言。

```typescript
i18n.setLocale("en-US") // 切换到英文
```

### i18n.subscribe(listener: () => void): () => void

订阅语言变更事件，返回取消订阅函数。

```typescript
const unsubscribe = i18n.subscribe(() => {
  console.log("Language changed to:", i18n.getCurrentLocale());
});

// 取消订阅
unsubscribe();
```

### i18n.getAvailableLocales()

获取所有可用语言列表。

```typescript
i18n.getAvailableLocales()
// [
//   { code: "zh-CN", label: "中文" },
//   { code: "en-US", label: "English" }
// ]
```

## 注意事项

1. **类型安全**: 所有翻译文件使用 `as const` 断言，确保类型推断正确
2. **组件更新**: 所有组件需要订阅 i18n 变更并调用 `this.requestUpdate()`
3. **清理订阅**: Lit 的反应性系统会自动处理，无需手动清理
4. **默认语言**: 默认语言为中文（zh-CN），可通过 localStorage 修改
5. **翻译键**: 如果翻译键不存在，会返回键本身作为后备

## 相关文件

- `src/i18n/i18n-manager.ts` - i18n 管理器
- `src/i18n/locales/zh-CN.ts` - 中文翻译
- `src/i18n/locales/en-US.ts` - 英文翻译
- `src/components/Navbar.ts` - 语言切换器示例